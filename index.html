<!DOCTYPE html>
<html>
<head>
  <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
</head>
<body>
  <a-scene 
    xr="requiredFeatures: local-floor, controllers" 
    webxr
  >
    <!-- Камера и контроллеры -->
    <a-entity 
      id="left-controller" 
      hand-controls="left" 
      thumbstick-movement
    ></a-entity>
    <a-entity 
      id="right-controller" 
      hand-controls="right"
    ></a-entity>
    <a-entity camera look-controls position="0 1.6 0"></a-entity>

    <!-- Объекты сцены -->
    <a-box position="0 0.5 -3" color="#4CC3D9"></a-box>
    <a-sky color="#ECECEC"></a-sky>
  </a-scene>

  <script>
    // Компонент для перемещения через джойстик
    AFRAME.registerComponent('thumbstick-movement', {
      init: function () {
        this.speed = 0.1;
        this.direction = new THREE.Vector3();

        this.el.addEventListener('axismove', (evt) => {
          if (evt.detail.axis.length > 1) {
            const [xAxis, yAxis] = evt.detail.axis;
            this.direction.set(xAxis, 0, -yAxis).normalize();
          }
        });
      },

      tick: function () {
        const camera = document.querySelector('[camera]');
        const position = camera.getAttribute('position');
        const newPosition = {
          x: position.x + this.direction.x * this.speed,
          y: position.y,
          z: position.z + this.direction.z * this.speed
        };
        camera.setAttribute('position', newPosition);
      }
    });
  </script>
</body>
</html>
